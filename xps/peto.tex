% !TEX encoding   = UTF-8
% !TEX program    = LuaLaTeX
% !TEX spellcheck = de_DE
\documentclass[a4paper]{article}
\usepackage[usenames,dvipsnames]{color}
\usepackage{siunitx}
\usepackage[german]{babel}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{units}
%\usetikzlibrary{datavisualization} 

\usetikzlibrary{arrows,chains,matrix,shapes}
\usepackage{luacode}
\usepackage{helvet}

%\usepackage[landscape]{geometry}
%\setmainfont{Ubuntu}
%\setmainfont{Linux Libertine}
%\setsansfont{Linux Biolinum}
\usepackage{paratype}
\renewcommand*\familydefault{\sfdefault} %% Only if the base font of the document is to be sans serif
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\pagestyle{fancy}
\usepackage{subcaption}
\usepackage{adjustbox}

\usepackage[top=0cm, bottom=0cm, left=0.5cm, right=0.5cm]{geometry}


\rhead{ Gruppe 6}
\lhead{\textbf{XPS} Spektren}
\fancyheadoffset{-1cm}
\pagenumbering{gobble}
\usetikzlibrary{pgfplots.groupplots}

\begin{luacode*}


  fs = dofile("fs.lua")

  function drawAG()

  px,py = fs.readanalyse("data/pet/oanalyse.txt",0,1,2)
  cscanax,cscanay = fs.readanalyse("data/pet/oanalyse.txt",0,1,3)
  cscanbx,cscanby = fs.readanalyse("data/pet/oanalyse.txt",0,1,4)
  backgroundx,backgroundy = fs.readanalyse("data/pet/oanalyse.txt",0,1,5)
  envelopex,envelopey = fs.readanalyse("data/pet/oanalyse.txt",0,1,6)
  residuex,residuey = fs.readanalyse("data/pet/oanalyse.txt",0,1,7)


  tex.sprint("\\addplot[".."darkblue".."] coordinates{")
    for i=1,#px do
    tex.sprint("("..px[i]..","..py[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{Grund}")
  tex.sprint("\\addplot[".."rouge".."] coordinates{")
    for i=1,#cscanax do
    tex.sprint("("..cscanax[i]..","..cscanay[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{O1s Scan A}")
  tex.sprint("\\addplot[".."green".."] coordinates{")
    for i=1,#cscanbx do
    tex.sprint("("..cscanbx[i]..","..cscanby[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{O1s Scan B}")
  
  tex.sprint("\\addplot[".."yellow".."] coordinates{")
    for i=1,#backgroundx do
    tex.sprint("("..backgroundx[i]..","..backgroundy[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{Hintergrund}")

 tex.sprint("\\addplot[".."black, dotted".."] coordinates{")
    for i=1,#envelopex do
    tex.sprint("("..envelopex[i]..","..envelopey[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{Umschlag}")

 tex.sprint("\\addplot[".."teal".."] coordinates{")
    for i=1,#residuex do
    tex.sprint("("..residuex[i]..","..residuey[i]..")")
    end
  tex.sprint("};")

  tex.sprint("\\addlegendentry{Residue}")


  end






\end{luacode*}


\newcommand\addplotpr{\directlua{drawAG()}}



\definecolor{skyblue1}{RGB}{135, 206, 250}
\definecolor{flame}{RGB}{226, 88, 34}
\definecolor{scarletred1}{RGB}{252, 40, 71}
\definecolor{cyanblau}{RGB}{0, 158, 224}
\definecolor{darkblue}{RGB}{0, 0,139}
\definecolor{charcoal}{rgb}{0.21, 0.27, 0.31}
\definecolor{turquoise}{rgb}{0 0.41 0.41}
\definecolor{rouge}{rgb}{0.79 0.0 0.1}
\definecolor{vert}{rgb}{0.15 0.4 0.1}
\definecolor{mauve}{rgb}{0.6 0.4 0.8}
\definecolor{violet}{rgb}{0.58 0. 0.41}
\definecolor{orange}{rgb}{0.8 0.4 0.2}
\definecolor{bleu}{rgb}{0.39, 0.58, 0.93}
\definecolor{azulen}{RGB}{0,218,255}



\begin{document}

\pgfplotsset{
  standard/.style={
    axis x line*=bottom,
    axis y line=left,
    ylabel= Intensität ,
    ylabel= Bindungs Energie ,
    x unit= \si{\per\centi\meter},
    legend style={at={(0.3,1)},anchor=north},
    y label style={at={(axis description cs:-.1,.5)},anchor=south},
    x tick label style={rotate=90,anchor=east, font=\tiny},
    tick label style={/pgf/number format/assume math mode=true,font=\sffamily},
    yticklabel style={/pgf/number format/fixed},
    scaled y ticks=false,
    legend cell align=left,
    x dir=reverse
  }
}
\pgfplotsset{tick style={very thin,gray}}

\begin{tikzpicture}[every node/.style={scale=0.6}]
  \begin{axis}[standard,title= Spektrum von PET, line width=0.1pt, enlarge x limits={abs=0.2cm},minor x tick num=1, xlabel=$\tilde{\nu}$]
    \addplotpr
    \end{axis}
  \end{tikzpicture}


%\node[coordinate,pin=left:{ \scriptsize ÄP bei pH = 7 und $\ce{V_{NaOH}}$ = 2.5 \si{\milli\liter}}] at (axis cs:2.5,7) {};



  \end{document}
