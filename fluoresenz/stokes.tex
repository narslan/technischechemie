% !TEX encoding   = UTF-8
% !TEX program    = LuaLaTeX
% !TEX spellcheck = de_DE
\documentclass[a4paper]{article}
\usepackage{fontspec}
\usepackage[usenames,dvipsnames]{color}
\usepackage{siunitx}
\usepackage[german]{babel}

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{units}


\usepackage{luacode}
\definecolor{skyblue1}{rgb}{0.447,0.624,0.812}
\definecolor{scarletred1}{rgb}{0.937,0.161,0.161}
\definecolor{chameleon1}{rgb}{0.541,0.886,0.204}
%\usepackage{helvet}

%\usepackage[landscape]{geometry}
%\setmainfont{Ubuntu}
\defaultfontfeatures{Ligatures=TeX,Numbers=OldStyle,Scale=MatchLowercase}
\setmainfont{Linux Libertine}
\setsansfont{Linux Biolinum}
\usepackage{fancyhdr}
\pagestyle{fancy}
\usepackage{subcaption}


\rhead{ Gruppe 6}
\lhead{\textbf{Fluoreszenzspektroskopie} Stokes Verschiebung}
\setlength{\headheight}{15pt}
\pagenumbering{gobble}
\usetikzlibrary{pgfplots.groupplots}

%\usepackage{caption}

%\usepackage{libertine}
%\usepackage{beramono}
%\setmainfont{Ubuntu}
\begin{luacode*}

  fs = dofile("fs.lua")

  function drawPU()

  ph12ax,ph12ay = fs.readcsv("data/ph12anregung420_410.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph12emmissions_360_370.txt",23)



  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")



  end

  function drawZU()

  ph12ax,ph12ay = fs.readcsv("data/ph12anregung_350_340.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph12emmissions_320_330.txt",23)



  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")

  end

  function drawHU()

  ph12ax,ph12ay = fs.readcsv("data/ph06anregung420_410.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph06emmissions_360_370.txt",23)

  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")

  end

  function drawOU()

  ph12ax,ph12ay = fs.readcsv("data/ph06anregung350_340.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph06emmissions_320_330.txt",23)



  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")

  end

  function drawBU()

  ph12ax,ph12ay = fs.readcsv("data/ph02anregung420_410.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph02emmissions_360_370.txt",23)

  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")

  end

  function drawIU()

  ph12ax,ph12ay = fs.readcsv("data/ph02anregung350_340.txt",23)
  ph12ex,ph12ey = fs.readcsv("data/ph02emmissions_320_330.txt",23)



  tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#ph12ax do
    tex.sprint("("..ph12ax[i]..","..ph12ay[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Anregung}")

  tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#ph12ex do
    tex.sprint("("..ph12ex[i]..","..ph12ey[i]..")")
    end
  tex.sprint("};")
  tex.sprint("\\addlegendentry{Emission}")

  end




\end{luacode*}


\newcommand\addplotzz{\directlua{drawPU()}}
\newcommand\addplotyu{\directlua{drawZU()}}
\newcommand\addplothu{\directlua{drawHU()}}
\newcommand\addplotou{\directlua{drawOU()}}
\newcommand\addplotbu{\directlua{drawBU()}}
\newcommand\addplotiu{\directlua{drawIU()}}


\begin{document}
\pgfplotsset{
  standard/.style={
    axis x line=bottom,
    axis y line=middle,
    xlabel= Wellenlänge, % Set the labels
    ylabel= Intensität ,
    x unit= \si{\nano\meter},
    legend style={at={(0,1)},anchor=north},
    y label style={at={(axis description cs:-.19,.5)},rotate=90,anchor=south},
    x tick label style={rotate=90,anchor=east},
    yticklabel style={/pgf/number format/sci},
    scaled y ticks=false
  }
}
\tikzset{
  every pin/.style={fill=scarletred1,rectangle,rounded corners=3pt,font=\tiny},
  small dot/.style={fill=chameleon1,circle,scale=0.3}
}

\begin{tikzpicture}
\begin{groupplot}[group style={group size=2 by 3,horizontal sep=15pt,vertical sep=50pt,xlabels at=edge bottom,ylabels at=edge left,}]
  \nextgroupplot[standard,title= \textbf{ph 12}]
  \addplotzz
  \nextgroupplot[standard,title= \textbf{ph 12}]
  \addplotyu
  \nextgroupplot[standard,title=\textbf{ph 6}]
  \addplothu
  \nextgroupplot[standard,title= \textbf{ph 6} ]
  \addplotou
  \nextgroupplot[standard,title=\textbf{ph 2}]
  \addplotbu
  \nextgroupplot[standard,title= \textbf{ph 2} ]
  \addplotiu
  \end{groupplot}
\end{tikzpicture}





    \end{document}
