% !TEX encoding   = UTF-8
% !TEX program    = LuaLaTeX
% !TEX spellcheck = de_DE
\documentclass[12pt]{article}
\usepackage{amsmath,mathtools}
\usepackage[usenames,dvipsnames]{xcolor}
%\usepackage[bitstream-charter]{mathdesign}
\usepackage{microtype}
\usepackage{fontspec}
\usepackage{graphicx}
\usepackage{siunitx}
\usepackage[german]{babel}
\usepackage{comment}
\usepackage{nicefrac}
\usepackage{booktabs}
\usepackage{float}
\usepackage{tikz}
\usetikzlibrary{arrows,chains,matrix,shapes,decorations}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepackage[backend=biber,sorting=none,autocite = superscript,natbib=true]{biblatex} \addbibresource{books.bib}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{luacode}
\floatstyle{plaintop}
\restylefloat{table}
%\usepackage[justification=justified,singlelinecheck=false]{caption}
\usepgfplotslibrary{units}
\usetikzlibrary{pgfplots.groupplots}
%\usepackage{gensymb}

\usepackage{fancyhdr}
\fancyhf{}
\rhead{13.12.2016}
\lhead{Nevroz Arslan, Justin KÃ¶nig Gruppe 6}
\setlength{\headheight}{15pt}
\rfoot{\thepage }
\lfoot{Versuch 1: Fluoreszenzspektroskopie}
\pagestyle{fancy}

\usepackage{url}
\usepackage{csquotes}
\sisetup{
  round-mode          = figures,
  round-precision     = 2,
  inter-unit-product =\cdot,
   group-digits=true,          %% Zifferngruppierung an/aus
        scientific-notation = true,
}
\renewcommand{\arraystretch}{1.5}
%\usepackage{unicode-math}

\setmainfont[Numbers = OldStyle,Ligatures = TeX,SmallCapsFeatures = {Renderer=Basic}]{Minion Pro}
\setsansfont[Numbers={OldStyle,Proportional},Scale=MatchLowercase]{Minion Pro}
\setmonofont[Numbers=OldStyle,Scale=MatchLowercase]{Minion Pro}
%\setmathfont{MnSymbol}
%\setmathfont[range=\mathup/{num,latin,Latin,greek,Greek}]{Minion Pro}
%\setmathfont[range=\mathbfup/{num,latin,Latin,greek,Greek}]{MinionPro-Bold}
%\setmathfont[range=\mathit/{num,latin,Latin,greek,Greek}]{MinionPro-It}
%\setmathfont[range=\mathbfit/{num,latin,Latin,greek,Greek}]{MinionPro-BoldIt}
%\setmathrm{Minion Pro}
%usepackage{sansmath} % Enables turning on sans-serif math mode, and using other environments

\begin{luacode*}

fs = dofile("fs.lua")

function drawPU()

xwerte, ywerte = fs.readcsv("data/ph12anregung420_410.txt",23)
xa, xb= fs.readcsv("data/ph02anregung350_340.txt",23)


    tex.sprint("\\addplot[".."no marks,blue".."] coordinates{")

    for i=1,#xwerte do
      tex.sprint("("..xwerte[i]..","..ywerte[i]..")")
    end
    tex.sprint("};")
     tex.sprint("\\addlegendentry{2-Naphtholat}")

 tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#xa do
      tex.sprint("("..xa[i]..","..xb[i]..")")
    end
    tex.sprint("};")
     tex.sprint("\\addlegendentry{2-Naphthol}")



end


function drawISO()

xwerte, ywerte = fs.readcsv("data/ph02anregung420_410.txt",23)
xa1, xb1= fs.readcsv("data/ph06anregung420_410.txt",23)
xa2, xb2= fs.readcsv("data/ph12anregung420_410.txt",23)


    tex.sprint("\\addplot[".."no marks,red".."] coordinates{")

    for i=1,#xwerte do
      tex.sprint("("..xwerte[i]..","..ywerte[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 2}")


 tex.sprint("\\addplot[".."no marks,orange".."] coordinates{")
    for i=1,#xa2 do
      tex.sprint("("..xa1[i]..","..xb1[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 6}")


 tex.sprint("\\addplot[".."no marks,black".."] coordinates{")
    for i=1,#xa2 do
      tex.sprint("("..xa2[i]..","..xb2[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 12}")

end

function drawISO2()

xwerte, ywerte = fs.readcsv("data/ph02anregung350_340.txt",23)
xa1, xb1= fs.readcsv("data/ph06anregung350_340.txt",23)
xa2, xb2= fs.readcsv("data/ph12anregung_350_340.txt",23)


    tex.sprint("\\addplot[".."smooth,thick,red".."] coordinates{")

    for i=1,#xwerte do
      tex.sprint("("..xwerte[i]..","..ywerte[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 2}")


 tex.sprint("\\addplot[".."smooth,orange,thick".."] coordinates{")
    for i=1,#xa1 do
      tex.sprint("("..xa1[i]..","..xb1[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 6}")


 tex.sprint("\\addplot[".."smooth,thick,black".."] coordinates{")
    for i=1,#xa2 do
      tex.sprint("("..xa2[i]..","..xb2[i]..")")
    end
    tex.sprint("};")
   tex.sprint("\\addlegendentry{ph 12}")

end

\end{luacode*}
\definecolor{skyblue1}{RGB}{135, 206, 250}
\definecolor{flame}{RGB}{226, 88, 34}
\definecolor{scarletred1}{RGB}{252, 40, 71}
\definecolor{cyanblau}{RGB}{0, 158, 224}
\definecolor{charcoal}{rgb}{0.21, 0.27, 0.31}
\definecolor{turquoise}{rgb}{0 0.41 0.41}
\definecolor{rouge}{rgb}{0.79 0.0 0.1}
\definecolor{vert}{rgb}{0.15 0.4 0.1}
\definecolor{mauve}{rgb}{0.6 0.4 0.8}
\definecolor{violet}{rgb}{0.58 0. 0.41}
\definecolor{orange}{rgb}{0.8 0.4 0.2}
\definecolor{bleu}{rgb}{0.39, 0.58, 0.93}
\definecolor{darkblue}{RGB}{0, 0,139}
\definecolor{azulen}{RGB}{0,218,255}
\newcommand\addplotzz{\directlua{drawPU()}}
\newcommand\addplotiso{\directlua{drawISO()}}
\newcommand\addplotaa{\directlua{drawISO2()}}



\begin{document}

\subsection{Aufbau des Fluoreszenz-Spektrometers\supercite{skript}}
\begin{figure}[h]
  \begin{tikzpicture}[decoration=snake]{
      \draw (0,0) rectangle (2,1) node[pos=.5] (b) {\footnotesize Licht Quelle};
      \draw[->,decorate,flame] (2.2,0.2)  -- (4,0.2);
      \draw[->,decorate,yellow] (2.2,0.8)  -- (4,0.8);
      \draw[->,decorate,darkblue] (2.2,0.6)  -- (4,0.6);
      \draw[->,decorate,turquoise] (2.2,0.4)  -- (4,0.4);
      %\draw  decorate [decoration={name=zigzag}] {(0,2) -- (3,0)};
      \draw (4.2,0) rectangle (8.2,1) node[pos=.5] (b) {\footnotesize Anregungsmonochromator};
      %\draw[->,ultra thick] (5,0.25)  -- (6,0.25);
      \draw[->,decorate,darkblue,thick] (8.3,0.4)  -- (10.2,0.4) node[midway,above] (d) {$\lambda_{ex}$};
      \draw (10.3,0) rectangle (11.5,1) node[pos=.5] (e) {\footnotesize Probe};
      \draw[->,decorate,red] (10.4,-0.2)  -- (10.4,-2.3);
      \draw[->,decorate,mauve] (10.6,-0.2)  -- (10.6,-2.3);
      \draw[->,decorate,azulen] (10.8,-0.2)  -- (10.8,-2.3);
      \draw[->,decorate,green] (11.0,-0.2)  -- (11.0,-2.3);
      \draw[->,decorate,yellow] (11.0,-0.2)  -- (11.0,-2.3);
      %\draw[->,decorate] (9,-0.5)  -- (9,-2.3) node[pos=0.1] (d) {\tiny Lumineszenz mit verschiedenen $\lambda$};
      \draw (9.2,-2.4) rectangle (13,-3.4) node[pos=.5] (f) {\footnotesize Emissionsmonochromator };
      \draw[->,decorate,azulen,thick] (10.6,-3.5)  -- (10.6,-5) node[rotate=90,midway,above] (g) {$\lambda_{em}$};
      \draw (9.8,-5.1) rectangle (11.5,-6) node[pos=.5] (h) {\footnotesize Detektor };
      \draw (6.3,-2.1) rectangle (8.5,-3.4) node[pos=.5] (j) {\footnotesize Ref. Detektor };
      \draw (6.3,-5.1) rectangle (8.5,-6) node[pos=.5] (k) {\footnotesize Computer };
      \draw[<->,dashed] (h)  -- (k);
      \draw[<->,dashed] (j)  -- (k);
      \draw[->,decorate,skyblue1,thick] (7.3,-0.2)  -- (7.3,-2.1) node[midway,above,rotate=90] (d) {$\lambda_{ex}$};
    }
  \end{tikzpicture}

\end{figure}

\begin{itemize}
    \item[] \tikz {\path[line width=2pt,->,dashed,draw=vert] 
        (0,0) -- (1,0) node[above,pos=0.5,text=vert] {IC};} Interne Konversion,
        $S_i\,\longrightarrow\,S_j$ non radiative transition.

    \item[] \tikz {\path[line width=2pt,->,dashed,draw=violet] 
        (0,0) -- (1,0) node[above,pos=0.5,text=violet] {ISC};} Intersystem-Crossing,
        $S_i\,\longrightarrow\,T_j$ non radiative transition.

    \item[] \tikz {\path[line width=2pt,draw=orange,ultra thick,
        decorate,decoration=snake] (0,0) -- (1,0) node[above,pos=0.5,text=orange] {RV};} 
        Schwingungsrelaxation.
\end{itemize}


\end{document}



